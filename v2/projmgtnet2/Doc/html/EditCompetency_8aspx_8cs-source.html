<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>PMT: D:/My Documents/Visual Studio Projects/projmgtnet2/PM/EditCompetency.aspx.cs Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.1 -->
<h1>D:/My Documents/Visual Studio Projects/projmgtnet2/PM/EditCompetency.aspx.cs</h1><div class="fragment"><pre>00001 <span class="keyword">using</span> System;
00002 <span class="keyword">using</span> System.Collections;
00003 <span class="keyword">using</span> System.ComponentModel;
00004 <span class="keyword">using</span> System.Data;
00005 <span class="keyword">using</span> System.Data.SqlClient;
00006 <span class="keyword">using</span> System.Drawing;
00007 <span class="keyword">using</span> System.Web;
00008 <span class="keyword">using</span> System.Web.SessionState;
00009 <span class="keyword">using</span> System.Web.UI;
00010 <span class="keyword">using</span> System.Web.UI.WebControls;
00011 <span class="keyword">using</span> System.Web.UI.HtmlControls;
00012 <span class="keyword">using</span> MySql;
00013 <span class="keyword">using</span> MySql.Data;
00014 <span class="keyword">using</span> MySql.Data.MySqlClient;
00015 
00016 <span class="keyword">namespace </span>PMT.PM
00017 {
<a name="l00021"></a><a class="code" href="classPMT_1_1PM_1_1EditCompetency.html">00021</a>     <span class="keyword">public</span> <span class="keyword">class </span><a class="code" href="classPMT_1_1PM_1_1EditCompetency.html">EditCompetency</a> : System.Web.UI.Page
00022     {
00023         <span class="keyword">protected</span> System.Web.UI.WebControls.Label IDLabel;
00024         <span class="keyword">protected</span> System.Web.UI.WebControls.Label FirstNameLabel;
00025         <span class="keyword">protected</span> System.Web.UI.WebControls.Label LastNameLabel;
00026         <span class="keyword">protected</span> System.Web.UI.WebControls.Label PresentCompetenceLabel;
00027         <span class="keyword">protected</span> System.Web.UI.WebControls.Button SaveButton;
00028         <span class="keyword">protected</span> System.Web.UI.WebControls.Button CancelButton;
00029         <span class="keyword">protected</span> System.Web.UI.WebControls.Label devFirstLabel;
00030         <span class="keyword">protected</span> System.Web.UI.WebControls.Label devLastLabel;
00031         <span class="keyword">protected</span> System.Web.UI.WebControls.DropDownList DeveloperDropDownList;
00032         <span class="keyword">protected</span> System.Web.UI.WebControls.DropDownList CompetenceDropDownList;
00033         <span class="keyword">protected</span> System.Web.UI.WebControls.Panel DeveloperPanel;
00034     
<a name="l00035"></a><a class="code" href="classPMT_1_1PM_1_1EditCompetency.html#PMT_1_1PM_1_1EditCompetencyd0">00035</a>         <span class="keyword">private</span> <span class="keywordtype">void</span> Page_Load(object sender, System.EventArgs e)
00036         {
00037             <span class="comment">// Put user code to initialize the page here</span>
00038 
00039             <span class="keywordflow">if</span>(!Page.IsPostBack)
00040             {
00042                 <span class="comment">// initialize the DB object</span>
00043                 <a class="code" href="classPMT_1_1DBDriver.html">DBDriver</a> myDB=<span class="keyword">new</span> <a class="code" href="classPMT_1_1DBDriver.html">DBDriver</a>();
00044                 <span class="comment">//set the query to select all projects</span>
00045                 myDB.<a class="code" href="classPMT_1_1DBDriver.html#PMT_1_1DBDriver00">Query</a> = <span class="stringliteral">"select p.ID as ID, p.lastName as lastName, p.firstName as firstName\n"</span>
00046                            + <span class="stringliteral">"from users u, person p\n"</span>
00047                            + <span class="stringliteral">"where u.security = 'Developer'\n"</span>
00048                            + <span class="stringliteral">"and p.ID = u.ID;"</span>;
00049                 <span class="comment">//create a data set</span>
00050                 <span class="comment">//DataSet ds=new DataSet();</span>
00051                 <span class="comment">//initialize the data adapter</span>
00052                 <span class="comment">//fill the data set with the data adapter</span>
00053                 MySqlDataReader dr = myDB.<a class="code" href="classPMT_1_1DBDriver.html#PMT_1_1DBDrivera3">createReader</a>();
00054                 <span class="keywordtype">int</span> i = 1;
00055                 DeveloperDropDownList.Items.Insert(0,<span class="stringliteral">""</span>);
00056                 <span class="keywordflow">while</span>( dr.Read() )
00057                 {
00058                     DeveloperDropDownList.Items.Insert(i,dr[<span class="stringliteral">"lastName"</span>].ToString() + <span class="stringliteral">", "</span> + dr[<span class="stringliteral">"firstName"</span>].ToString());
00059                     DeveloperDropDownList.Items[i].Value = dr[<span class="stringliteral">"ID"</span>].ToString();
00060                     i++;
00061                 }
00062 
00063                 myDB.<a class="code" href="classPMT_1_1DBDriver.html#PMT_1_1DBDrivera1">close</a>();
00064 
00065                 CompetenceDropDownList.Items.Insert(0,<span class="stringliteral">"Low"</span>);
00066                 CompetenceDropDownList.Items[0].Value= <span class="stringliteral">"Low"</span>;
00067                 CompetenceDropDownList.Items.Insert(1,<span class="stringliteral">"Medium"</span>);
00068                 CompetenceDropDownList.Items[1].Value= <span class="stringliteral">"Medium"</span>;
00069                 CompetenceDropDownList.Items.Insert(2,<span class="stringliteral">"High"</span>);
00070                 CompetenceDropDownList.Items[2].Value= <span class="stringliteral">"High"</span>;
00071             }
00072 
00073         }
00074 
00075 <span class="preprocessor">        #region Web Form Designer generated code</span>
00076 <span class="preprocessor"></span>        override <span class="keyword">protected</span> <span class="keywordtype">void</span> OnInit(EventArgs e)
00077         {
00078             <span class="comment">//</span>
00079             <span class="comment">// CODEGEN: This call is required by the ASP.NET Web Form Designer.</span>
00080             <span class="comment">//</span>
00081             InitializeComponent();
00082             base.OnInit(e);
00083         }
00084         
<a name="l00089"></a><a class="code" href="classPMT_1_1PM_1_1EditCompetency.html#PMT_1_1PM_1_1EditCompetencyd1">00089</a>         <span class="keyword">private</span> <span class="keywordtype">void</span> InitializeComponent()
00090         {    
00091             <span class="keyword">this</span>.DeveloperDropDownList.SelectedIndexChanged += <span class="keyword">new</span> System.EventHandler(<span class="keyword">this</span>.DeveloperDropDownList_SelectedIndexChanged);
00092             <span class="keyword">this</span>.SaveButton.Click += <span class="keyword">new</span> System.EventHandler(<span class="keyword">this</span>.Button_Click);
00093             <span class="keyword">this</span>.CancelButton.Click += <span class="keyword">new</span> System.EventHandler(<span class="keyword">this</span>.Button_Click);
00094             <span class="keyword">this</span>.Load += <span class="keyword">new</span> System.EventHandler(<span class="keyword">this</span>.Page_Load);
00095 
00096         }
00097 <span class="preprocessor">        #endregion</span>
00098 <span class="preprocessor"></span>
00099         <span class="keyword">private</span> <span class="keywordtype">void</span> DeveloperDropDownList_SelectedIndexChanged(object sender, System.EventArgs e)
00100         {
00101             <span class="comment">/*</span>
00102 <span class="comment">             * get developer info and display it ...</span>
00103 <span class="comment">             * </span>
00104 <span class="comment">             * */</span>
00105 
00106 
00107             <span class="comment">//initialize the DB object</span>
00108             DBDriver myDB=<span class="keyword">new</span> DBDriver();
00109             <span class="comment">//set the appropriate SQL query</span>
00110             myDB.Query = <span class="stringliteral">"select person.ID, firstName, lastName, competence"</span>
00111                        + <span class="stringliteral">" from person, compLevels"</span>
00112                        + <span class="stringliteral">" where person.ID = compLevels.ID and person.ID=@devID;"</span>;
00113             myDB.addParam(<span class="stringliteral">"@devID"</span>, DeveloperDropDownList.SelectedValue);
00114 
00115             <span class="comment">//initialize the datareader</span>
00116             MySqlDataReader dr = myDB.createReader();
00117             <span class="comment">//fill the datareader</span>
00118             dr.Read();
00119 
00120             <span class="keyword">this</span>.CancelButton.Visible = <span class="keyword">true</span>; <span class="comment">//reset buttons</span>
00121             <span class="keyword">this</span>.SaveButton.Visible = <span class="keyword">true</span>;
00122             <span class="keyword">this</span>.CompetenceDropDownList.Visible= <span class="keyword">true</span>;
00123     
00124             
00125             <span class="keywordflow">try</span>
00126             {
00127                 <span class="keyword">this</span>.devFirstLabel.Text=Convert.ToString(dr[<span class="stringliteral">"firstName"</span>]);
00128                 <span class="keyword">this</span>.devLastLabel.Text=Convert.ToString(dr[<span class="stringliteral">"lastName"</span>]);
00129                 <span class="keyword">this</span>.CompetenceDropDownList.SelectedValue = dr[<span class="stringliteral">"competence"</span>].ToString();
00130             }
00131             <span class="keywordflow">catch</span>
00132             {
00133                 <span class="keyword">this</span>.devFirstLabel.Text=<span class="stringliteral">"ERROR"</span>;
00134                 <span class="keyword">this</span>.devLastLabel.Text=<span class="stringliteral">"ERROR"</span>;
00135             }
00136 
00137             myDB.close();
00138         
00139 
00140             
00141             DeveloperPanel.Visible = <span class="keyword">true</span>;
00142         }
00143 
00144         <span class="keyword">private</span> <span class="keywordtype">void</span> Button_Click(object sender, System.EventArgs e)
00145         {
00146             <span class="keywordflow">if</span> (sender.Equals(<span class="keyword">this</span>.SaveButton))
00147             {
00148                 <span class="comment">//initialize the DB object</span>
00149                 DBDriver myDB=<span class="keyword">new</span> DBDriver();
00150                 <span class="comment">//set the appropriate SQL query</span>
00151                 myDB.Query=<span class="stringliteral">"update compLevels"</span>
00152                     +<span class="stringliteral">" set competence=@compLevel"</span>
00153                     +<span class="stringliteral">" where ID=@devID;"</span>;
00154                 myDB.addParam(<span class="stringliteral">"@devID"</span>, DeveloperDropDownList.SelectedValue);
00155                 myDB.addParam(<span class="stringliteral">"@compLevel"</span>, CompetenceDropDownList.SelectedValue);
00156                 myDB.nonQuery();
00157                 <span class="keyword">this</span>.syncCompetenceText();<span class="comment">//sync back both inputs to database values.</span>
00158             }
00159             <span class="keywordflow">else</span>
00160                 syncCompetenceText();
00161 
00162                 <span class="keywordflow">return</span>;
00163             
00164                 
00165         }
00166 
00167         <span class="keyword">private</span> <span class="keywordtype">void</span> syncCompetenceText()
00168         {
00169             <span class="comment">//initialize the DB object</span>
00170             DBDriver myDB=<span class="keyword">new</span> DBDriver();
00171             <span class="comment">//set the appropriate SQL query</span>
00172             myDB.Query=<span class="stringliteral">"select ID, competence"</span>
00173                 +<span class="stringliteral">" from compLevels"</span>
00174                 +<span class="stringliteral">" where compLevels.ID=@devID;"</span>;
00175             myDB.addParam(<span class="stringliteral">"@devID"</span>, DeveloperDropDownList.SelectedValue);
00176             <span class="comment">//initialize the datareader</span>
00177             MySqlDataReader dr = myDB.createReader();
00178             <span class="comment">//fill the datareader</span>
00179             dr.Read();
00180             <span class="keyword">this</span>.CompetenceDropDownList.SelectedValue = Convert.ToString(dr[<span class="stringliteral">"competence"</span>]);
00181             myDB.close();
00182             
00183         }
00184 
00185 
00186     }
00187 }
</pre></div><hr><address style="align: right;"><small>
Generated on Sat Aug 5 14:40:47 2006 for PMT by <a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 width=110 height=53>
</a> 1.3.1 using KingsTools</small></address>
</body>
</html>
