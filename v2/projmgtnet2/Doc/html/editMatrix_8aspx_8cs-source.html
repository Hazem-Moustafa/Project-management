<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>PMT: D:/My Documents/Visual Studio Projects/projmgtnet2/Admin/editMatrix.aspx.cs Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.1 -->
<h1>D:/My Documents/Visual Studio Projects/projmgtnet2/Admin/editMatrix.aspx.cs</h1><div class="fragment"><pre>00001 <span class="keyword">using</span> System;
00002 <span class="keyword">using</span> System.Collections;
00003 <span class="keyword">using</span> System.ComponentModel;
00004 <span class="keyword">using</span> System.Data;
00005 <span class="keyword">using</span> System.Drawing;
00006 <span class="keyword">using</span> System.Web;
00007 <span class="keyword">using</span> System.Web.SessionState;
00008 <span class="keyword">using</span> System.Web.UI;
00009 <span class="keyword">using</span> System.Web.UI.WebControls;
00010 <span class="keyword">using</span> System.Web.UI.HtmlControls;
00011 
00012 <span class="keyword">namespace </span>PMT.Admin
00013 {
<a name="l00017"></a><a class="code" href="classPMT_1_1Admin_1_1EditMatrix.html">00017</a>   <span class="keyword">public</span> <span class="keyword">class </span><a class="code" href="classPMT_1_1Admin_1_1EditMatrix.html">EditMatrix</a> : System.Web.UI.Page
00018   {
00019     <span class="keyword">protected</span> System.Web.UI.WebControls.DataGrid compMatrixGrid;
00020   
00021     <span class="keyword">private</span> <span class="keywordtype">void</span> Page_Load(object sender, System.EventArgs e)
00022     {
00023       <span class="comment">// Put user code to initialize the page here</span>
00024       <span class="comment">//load the current competency matrix from the database</span>
00025       DBDriver myDB=<span class="keyword">new</span> DBDriver();
00026       myDB.Query=<span class="stringliteral">"select * from compMatrix;"</span>;
00027       DataSet ds=<span class="keyword">new</span> DataSet();
00028       myDB.createAdapter().Fill(ds);
00029       <span class="keyword">this</span>.compMatrixGrid.DataSource=ds;
00030       <span class="keywordflow">if</span>(!<span class="keyword">this</span>.IsPostBack)
00031       {
00032         <span class="keyword">this</span>.compMatrixGrid.DataBind();
00033       }
00034     }
00035 
00036 <span class="preprocessor">    #region Web Form Designer generated code</span>
00037 <span class="preprocessor"></span>    override <span class="keyword">protected</span> <span class="keywordtype">void</span> OnInit(EventArgs e)
00038     {
00039       <span class="comment">//</span>
00040       <span class="comment">// CODEGEN: This call is required by the ASP.NET Web Form Designer.</span>
00041       <span class="comment">//</span>
00042       InitializeComponent();
00043       base.OnInit(e);
00044     }
00045         
<a name="l00050"></a><a class="code" href="classPMT_1_1Admin_1_1EditMatrix.html#PMT_1_1Admin_1_1EditMatrixd1">00050</a>     <span class="keyword">private</span> <span class="keywordtype">void</span> InitializeComponent()
00051     {    
00052       <span class="keyword">this</span>.compMatrixGrid.CancelCommand += <span class="keyword">new</span> System.Web.UI.WebControls.DataGridCommandEventHandler(<span class="keyword">this</span>.compMatrixGrid_CancelCommand);
00053       <span class="keyword">this</span>.compMatrixGrid.EditCommand += <span class="keyword">new</span> System.Web.UI.WebControls.DataGridCommandEventHandler(<span class="keyword">this</span>.compMatrixGrid_EditCommand);
00054       <span class="keyword">this</span>.compMatrixGrid.UpdateCommand += <span class="keyword">new</span> System.Web.UI.WebControls.DataGridCommandEventHandler(<span class="keyword">this</span>.compMatrixGrid_UpdateCommand);
00055       <span class="keyword">this</span>.Load += <span class="keyword">new</span> System.EventHandler(<span class="keyword">this</span>.Page_Load);
00056 
00057     }
00058 <span class="preprocessor">    #endregion</span>
00059 <span class="preprocessor"></span>
00060     <span class="keyword">private</span> <span class="keywordtype">void</span> compMatrixGrid_EditCommand(object source, System.Web.UI.WebControls.DataGridCommandEventArgs e)
00061     {
00062       <span class="comment">//edit the selected row</span>
00063       <span class="keyword">this</span>.compMatrixGrid.EditItemIndex=e.Item.ItemIndex;
00064       <span class="keyword">this</span>.compMatrixGrid.DataBind();
00065     }
00066 
00067     <span class="keyword">private</span> <span class="keywordtype">void</span> compMatrixGrid_CancelCommand(object source, System.Web.UI.WebControls.DataGridCommandEventArgs e)
00068     {
00069       <span class="comment">//cancel editing of the selected row</span>
00070       <span class="keyword">this</span>.compMatrixGrid.EditItemIndex=-1;
00071       <span class="keyword">this</span>.compMatrixGrid.DataBind();
00072     }
00073 
00074     <span class="keyword">private</span> <span class="keywordtype">void</span> compMatrixGrid_UpdateCommand(object source, System.Web.UI.WebControls.DataGridCommandEventArgs e)
00075     {
00076       DBDriver myDB=<span class="keyword">new</span> DBDriver();
00077       <span class="comment">//retrieve the new values from the datagrid</span>
00078       TextBox tb;
00079       tb=(TextBox)e.Item.Cells[1].Controls[0];
00080       string low=tb.Text;
00081       tb=(TextBox)e.Item.Cells[2].Controls[0];
00082       string med=tb.Text;
00083       tb=(TextBox)e.Item.Cells[3].Controls[0];
00084       string high=tb.Text;
00085       string level = e.Item.Cells[0].Text;
00086 
00087       <span class="comment">//store new values to DB</span>
00088       myDB.Query=<span class="stringliteral">"update compMatrix set lowComplexity=@low, medComplexity=@med, highComplexity=@high where compLevel=@level;"</span>;
00089       myDB.addParam(<span class="stringliteral">"@low"</span>, low);
00090       myDB.addParam(<span class="stringliteral">"@med"</span>, med);
00091       myDB.addParam(<span class="stringliteral">"@high"</span>, high);
00092       myDB.addParam(<span class="stringliteral">"@level"</span>, level);
00093       myDB.nonQuery();
00094 
00095       <span class="comment">//make sure nothing is being edited, and reload the page</span>
00096       <span class="keyword">this</span>.compMatrixGrid.EditItemIndex=-1;
00097       Response.Redirect(Request.Url.AbsolutePath);
00098     }
00099   }
00100 }
</pre></div><hr><address style="align: right;"><small>
Generated on Sat Aug 5 14:40:47 2006 for PMT by <a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 width=110 height=53>
</a> 1.3.1 using KingsTools</small></address>
</body>
</html>
