<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>PMT: D:/My Documents/Visual Studio Projects/projmgt-net/v2/projmgtnet2/PMTComponents/Project.cs Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.1 -->
<h1>D:/My Documents/Visual Studio Projects/projmgt-net/v2/projmgtnet2/PMTComponents/Project.cs</h1><div class="fragment"><pre>00001 <span class="keyword">using</span> System;
00002 <span class="keyword">using</span> System.Collections;
00003 <span class="keyword">using</span> System.Diagnostics;
00004 <span class="keyword">using</span> System.Data;
00005 <span class="keyword">using</span> System.Data.SqlClient;
00006 <span class="keyword">using</span> MySql;
00007 <span class="keyword">using</span> MySql.Data;
00008 <span class="keyword">using</span> MySql.Data.MySqlClient;
00009 <span class="keyword">using</span> PMT;
00010 
00011 <span class="keyword">namespace </span>PMTComponents
00012 {
<a name="l00016"></a><a class="code" href="classPMTComponents_1_1ProjectItem.html">00016</a>     <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class </span><a class="code" href="classPMTComponents_1_1ProjectItem.html">ProjectItem</a>
00017     {
<a name="l00021"></a><a class="code" href="structPMTComponents_1_1ProjectItem_1_1ItemType.html">00021</a>         <span class="keyword">public</span> <span class="keyword">struct </span><a class="code" href="structPMTComponents_1_1ProjectItem_1_1ItemType.html">ItemType</a>
00022         {
00023             <span class="keyword">public</span> <span class="keyword">const</span> string PROJECT = <span class="stringliteral">"Project"</span>;
00024             <span class="keyword">public</span> <span class="keyword">const</span> string MODULE = <span class="stringliteral">"Module"</span>;
00025             <span class="keyword">public</span> <span class="keyword">const</span> string TASK = <span class="stringliteral">"Task"</span>;
00026         };
00027 
00028         <span class="keyword">protected</span> string name;
00029         <span class="keyword">protected</span> string id;
00030         <span class="keyword">protected</span> string description;
00031         <span class="keyword">protected</span> string startDate;
00032         <span class="keyword">protected</span> string expEndDate;
00033         <span class="keyword">protected</span> string actEndDate;
00034         
00035         <span class="keyword">protected</span> <span class="keyword">const</span> string percentFormatter = <span class="stringliteral">"###.00%;###.00%;0.00%;"</span>;
00036 
00037         <span class="keyword">protected</span> DBDriver myDB;
00038 
<a name="l00045"></a><a class="code" href="classPMTComponents_1_1ProjectItem.html#PMTComponents_1_1ProjectItemb0">00045</a>         <span class="keyword">protected</span> <a class="code" href="classPMTComponents_1_1ProjectItem.html#PMTComponents_1_1ProjectItemb0">ProjectItem</a>(string name, string description, string startDate)
00046         {
00047             <span class="keyword">this</span>.name = name;
00048             <span class="keyword">this</span>.description = description;
00049             <span class="keyword">this</span>.startDate = startDate;
00050         }
00051 
<a name="l00056"></a><a class="code" href="classPMTComponents_1_1ProjectItem.html#PMTComponents_1_1ProjectItemb1">00056</a>         <span class="keyword">protected</span> <a class="code" href="classPMTComponents_1_1ProjectItem.html#PMTComponents_1_1ProjectItemb0">ProjectItem</a>(string id)
00057         {
00058             <span class="keyword">this</span>.id = id;
00059         }
00060  
<a name="l00067"></a><a class="code" href="classPMTComponents_1_1ProjectItem.html#PMTComponents_1_1ProjectItema0">00067</a>         <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classPMTComponents_1_1ProjectItem.html#PMTComponents_1_1ProjectItema0">update</a>(string name, string desc, string startDate)
00068         {
00069             <span class="keyword">this</span>.name = name;
00070             <span class="keyword">this</span>.description = desc;
00071             <span class="keyword">this</span>.startDate = startDate;
00072         }
00073 
00078         <span class="keyword">public</span> string <a class="code" href="classPMTComponents_1_1ProjectItem.html#PMTComponents_1_1Task04">Name</a>
<a name="l00079"></a><a class="code" href="classPMTComponents_1_1ProjectItem.html#PMTComponents_1_1Task04">00079</a>         {
00080             get {   <span class="keywordflow">return</span> name;    }
00081         }
00082 
00083         <span class="keyword">public</span> string ID
00084         {
00085             get {   <span class="keywordflow">return</span> id;  }
00086         }
00087 
00088         <span class="keyword">public</span> string Description
00089         {
00090             get {   <span class="keywordflow">return</span> description; }
00091         }
00092 
00093         <span class="keyword">public</span> string StartDate
00094         {
00095             get {   <span class="keywordflow">return</span> startDate;   }
00096         }
00097 
00098         <span class="keyword">public</span> string ExpEndDate
00099         {
00100             get {   <span class="keywordflow">return</span> expEndDate;  }
00101         }
00102 
00103         <span class="keyword">public</span> string ActEndDate
00104         {
00105             get {   <span class="keywordflow">return</span> actEndDate;  }
00106         }
00107     }
<a name="l00111"></a><a class="code" href="classPMTComponents_1_1Project.html">00111</a>     <span class="keyword">public</span> <span class="keyword">class </span><a class="code" href="classPMTComponents_1_1Project.html">Project</a> : <a class="code" href="classPMTComponents_1_1ProjectItem.html">ProjectItem</a>
00112     {
00113         <span class="keyword">protected</span> string mgrID;
00114 
<a name="l00119"></a><a class="code" href="classPMTComponents_1_1Project.html#PMTComponents_1_1Projecta0">00119</a>         <span class="keyword">public</span> <a class="code" href="classPMTComponents_1_1Project.html#PMTComponents_1_1Projecta0">Project</a>(string id)
00120             : base(id)
00121         {
00122             myDB = <span class="keyword">new</span> DBDriver();
00123             myDB.Query = <span class="stringliteral">"select * from projects \n"</span> + 
00124                 <span class="stringliteral">"where ID = @ID;"</span>;
00125             myDB.addParam(<span class="stringliteral">"@ID"</span>, id);
00126 
00127             DataSet ds = <span class="keyword">new</span> DataSet();
00128             myDB.createAdapter().Fill(ds);
00129             DataTable table = ds.Tables[0];
00130             DataRow row = table.Rows[0];
00131 
00132             <span class="keyword">this</span>.name = row[<span class="stringliteral">"Name"</span>].ToString();
00133             <span class="keyword">this</span>.id = row[<span class="stringliteral">"id"</span>].ToString();
00134             <span class="keyword">this</span>.mgrID = row[<span class="stringliteral">"managerID"</span>].ToString();
00135             <span class="keyword">this</span>.description = row[<span class="stringliteral">"description"</span>].ToString();
00136             <span class="keyword">this</span>.startDate = row[<span class="stringliteral">"startDate"</span>].ToString();
00137             <span class="keyword">this</span>.expEndDate = row[<span class="stringliteral">"expEndDate"</span>].ToString();
00138             <span class="keyword">this</span>.actEndDate = row[<span class="stringliteral">"actEndDate"</span>].ToString();
00139         }
00140 
00141         <span class="keyword">public</span> <a class="code" href="classPMTComponents_1_1Project.html#PMTComponents_1_1Projecta0">Project</a>(string name, string mgrID, string description, string startDate)
00142             : base(name, description, startDate)
00143         {
00144             DBDriver db = <span class="keyword">new</span> DBDriver();
00145             <span class="comment">// Create Adapter</span>
00146             db.Query = <span class="stringliteral">"select * from Projects"</span>;
00147             MySqlDataAdapter da = db.createAdapter();
00148             <span class="comment">// We need this to get an ID back from the database</span>
00149             da.MissingSchemaAction = MissingSchemaAction.AddWithKey;
00150             <span class="comment">// Create and initialize CommandBuilder</span>
00151             MySqlCommandBuilder dbCB = <span class="keyword">new</span> MySqlCommandBuilder(da);
00152 
00153             <span class="comment">// New DataSet</span>
00154             DataSet ds = <span class="keyword">new</span> DataSet();
00155             <span class="comment">// Populate DataSet with data</span>
00156             da.Fill(ds, <span class="stringliteral">"Projects"</span>);
00157 
00158             <span class="comment">// Get reference to our table</span>
00159             DataTable table = ds.Tables[<span class="stringliteral">"Projects"</span>];
00160             <span class="comment">// Create new row</span>
00161             DataRow  row = table.NewRow();
00162             <span class="comment">// Store data in the row</span>
00163             row[<span class="stringliteral">"Name"</span>] = <span class="keyword">this</span>.name = name;
00164             row[<span class="stringliteral">"managerID"</span>] = <span class="keyword">this</span>.mgrID = mgrID;
00165             row[<span class="stringliteral">"description"</span>] = <span class="keyword">this</span>.description = description;
00166             row[<span class="stringliteral">"startDate"</span>] = <span class="keyword">this</span>.startDate = startDate;
00167             <span class="comment">// Add row back to table</span>
00168             table.Rows.Add(row);
00169 
00170             <span class="comment">// Update data source</span>
00171             da.Update(ds, <span class="stringliteral">"Projects"</span>);
00172 
00173             <span class="comment">// Get newFileID</span>
00174             <span class="keywordflow">if</span>( !row.IsNull(<span class="stringliteral">"ID"</span>) )
00175                 id = row[<span class="stringliteral">"ID"</span>].ToString();
00176 
00177         }
00178 
<a name="l00186"></a><a class="code" href="classPMTComponents_1_1Project.html#PMTComponents_1_1Projecte0">00186</a>         <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classPMTComponents_1_1Project.html#PMTComponents_1_1Projecte0">create</a>(string name, string mID, string description, string startDate)
00187         {
00188             DBDriver myDB = <span class="keyword">new</span> DBDriver();
00189             myDB.Query=<span class="stringliteral">"insert into projects (name, managerID, description, startDate) \n"</span>
00190                 +<span class="stringliteral">"values ( @name, @mID, @desc, @start, @end );"</span>;
00191 
00192             myDB.addParam(<span class="stringliteral">"@name"</span>, name);
00193             myDB.addParam(<span class="stringliteral">"@mID"</span>, mID);
00194             myDB.addParam(<span class="stringliteral">"@desc"</span>, description);
00195             myDB.addParam(<span class="stringliteral">"@start"</span>, startDate);
00196         
00197             myDB.nonQuery();
00198         }
00199 
<a name="l00206"></a><a class="code" href="classPMTComponents_1_1Project.html#PMTComponents_1_1Projecta2">00206</a>         <span class="keyword">new</span> <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classPMTComponents_1_1Project.html#PMTComponents_1_1Projecta2">update</a>(string name, string description, string startDate)
00207         {
00208             base.update(name, description, startDate);
00209 
00210             DBDriver myDB = <span class="keyword">new</span> DBDriver();
00211             myDB.Query=<span class="stringliteral">"update projects \n"</span> 
00212                 +<span class="stringliteral">"set name=@name, description=@desc, startDate=@start \n"</span>
00213                 +<span class="stringliteral">"where id=@id;"</span>;
00214 
00215             myDB.addParam(<span class="stringliteral">"@id"</span>, <span class="keyword">this</span>.id);
00216             myDB.addParam(<span class="stringliteral">"@name"</span>, name);
00217             myDB.addParam(<span class="stringliteral">"@desc"</span>, description);
00218             myDB.addParam(<span class="stringliteral">"@start"</span>, startDate);
00219 
00220             myDB.nonQuery();
00221         }
00222 
<a name="l00227"></a><a class="code" href="classPMTComponents_1_1Project.html#PMTComponents_1_1Projecte1">00227</a>         <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classPMTComponents_1_1Project.html#PMTComponents_1_1Projecte1">remove</a>(string id)
00228         {
00229             DBDriver myDB = <span class="keyword">new</span> DBDriver();
00230             myDB.Query = <span class="stringliteral">"delete from Projects where id=@id"</span>;
00231             myDB.addParam(<span class="stringliteral">"@id"</span>, id);
00232             myDB.nonQuery();
00233         }
00234 
<a name="l00240"></a><a class="code" href="classPMTComponents_1_1Project.html#PMTComponents_1_1Projecte2">00240</a>         <span class="keyword">public</span> <span class="keyword">static</span> DataSet <a class="code" href="classPMTComponents_1_1Project.html#PMTComponents_1_1Projecte2">getByID</a>(string id)
00241         {
00242             DBDriver myDB = <span class="keyword">new</span> DBDriver();
00243             myDB.Query = <span class="stringliteral">"select * from projects \n"</span> + 
00244                 <span class="stringliteral">"where ID = @ID;"</span>;
00245             myDB.addParam(<span class="stringliteral">"@ID"</span>, id);
00246 
00247             DataSet ds = <span class="keyword">new</span> DataSet();
00248             myDB.createAdapter().Fill(ds);
00249             
00250             <span class="keywordflow">return</span> ds;
00251         }
00252 
<a name="l00256"></a><a class="code" href="classPMTComponents_1_1Project.html#PMTComponents_1_1Projecta3">00256</a>         <span class="keyword">public</span> DataSet <a class="code" href="classPMTComponents_1_1Project.html#PMTComponents_1_1Projecta3">getDataSet</a>()
00257         {
00258             DBDriver myDB = <span class="keyword">new</span> DBDriver();
00259             myDB.Query = 
00260                 <span class="stringliteral">"select * from projects \n"</span> + 
00261                 <span class="stringliteral">"where ID = @ID;"</span>;
00262             myDB.addParam(<span class="stringliteral">"@ID"</span>, id);
00263 
00264             DataSet ds = <span class="keyword">new</span> DataSet();
00265             myDB.createAdapter().Fill(ds);
00266             
00267             <span class="keywordflow">return</span> ds;
00268         }
00269 
<a name="l00274"></a><a class="code" href="classPMTComponents_1_1Project.html#PMTComponents_1_1Projecte3">00274</a>         <span class="keyword">public</span> <span class="keyword">static</span> DataSet <a class="code" href="classPMTComponents_1_1Project.html#PMTComponents_1_1Projecte3">getProjectsDataSet</a>()
00275         {
00276             DBDriver myDB = <span class="keyword">new</span> DBDriver();
00277             myDB.Query = <span class="stringliteral">"select * from projects;"</span>;
00278 
00279             DataSet ds = <span class="keyword">new</span> DataSet();
00280             myDB.createAdapter().Fill(ds);
00281             
00282             <span class="keywordflow">return</span> ds;
00283         }
00284 
<a name="l00290"></a><a class="code" href="classPMTComponents_1_1Project.html#PMTComponents_1_1Projecte4">00290</a>         <span class="keyword">public</span> <span class="keyword">static</span> DataSet <a class="code" href="classPMTComponents_1_1Project.html#PMTComponents_1_1Projecte3">getProjectsDataSet</a>(string mgrID)
00291         {
00292             DBDriver myDB = <span class="keyword">new</span> DBDriver();
00293             myDB.Query = <span class="stringliteral">"select * from projects \n"</span>
00294                 +<span class="stringliteral">"where managerID=@mgrID;"</span>;
00295             myDB.addParam(<span class="stringliteral">"@mgrID"</span>, mgrID);
00296 
00297             DataSet ds = <span class="keyword">new</span> DataSet();
00298             myDB.createAdapter().Fill(ds);
00299             
00300             <span class="keywordflow">return</span> ds;
00301         }
00302 
<a name="l00307"></a><a class="code" href="classPMTComponents_1_1Project.html#PMTComponents_1_1Projecta4">00307</a>         <span class="keyword">public</span> DataSet <a class="code" href="classPMTComponents_1_1Project.html#PMTComponents_1_1Projecta4">getModulesDataSet</a>()
00308         {
00309             myDB.Query = <span class="stringliteral">"select * from modules\n"</span> +
00310                 <span class="stringliteral">"where projectID = @ID;"</span>;
00311             myDB.addParam(<span class="stringliteral">"@ID"</span>, id);
00312 
00313             DataSet ds = <span class="keyword">new</span> DataSet();
00314             myDB.createAdapter().Fill(ds);
00315             <span class="keywordflow">return</span> ds;
00316         }
00317 
00318         
00322         <span class="keyword">public</span> string <a class="code" href="classPMTComponents_1_1Project.html#PMTComponents_1_1Project00">ProjectManagerID</a>
<a name="l00323"></a><a class="code" href="classPMTComponents_1_1Project.html#PMTComponents_1_1Project00">00323</a>         {
00324             get {   <span class="keywordflow">return</span> mgrID;   }
00325         }
00326         
00327 
00328 <span class="comment">//        public static void assignManager(string mID)</span>
00329 <span class="comment">//        {</span>
00330 <span class="comment">//            myDB.Query = "update Projects set managerID=@mID where ";</span>
00331 <span class="comment">//        }</span>
00332 
00336         <span class="keyword">public</span> string <a class="code" href="classPMTComponents_1_1Project.html#PMTComponents_1_1Project01">PercentComplete</a>
<a name="l00337"></a><a class="code" href="classPMTComponents_1_1Project.html#PMTComponents_1_1Project01">00337</a>         {
00338             get
00339             {
00340                 <span class="keywordtype">int</span> count = 0;
00341                 <span class="keywordtype">int</span> approved = 0;
00342 
00343                 DataTable modsTable = <span class="keyword">this</span>.getModulesDataSet().Tables[0];
00344                 foreach (DataRow modRow in modsTable.Rows)
00345                 {
00346                     DataTable tasksTable = <span class="keyword">new</span> <a class="code" href="classPMTComponents_1_1Module.html">Module</a>(modRow[<span class="stringliteral">"id"</span>].ToString()).getTasksDataSet().Tables[0];
00347                     foreach (DataRow taskRow in tasksTable.Rows)
00348                     {
00349                         <span class="keywordflow">if</span> (taskRow[<span class="stringliteral">"complete"</span>].ToString().Equals(<a class="code" href="structPMTComponents_1_1TaskStatus.html">TaskStatus</a>.APPROVED))
00350                             approved++;
00351                         count++;
00352                     }
00353                 }
00354                 <span class="keywordtype">double</span> pct = (<span class="keywordtype">double</span>)approved/(<span class="keywordtype">double</span>)count;
00355                 <span class="keywordflow">if</span> (Double.IsNaN(pct))
00356                     pct = 0;
00357                 <span class="keywordflow">return</span> Convert.ToString(pct.ToString(percentFormatter));
00358             }
00359         }
00360 
00361     }
00362 
<a name="l00366"></a><a class="code" href="classPMTComponents_1_1Module.html">00366</a>     <span class="keyword">public</span> <span class="keyword">class </span><a class="code" href="classPMTComponents_1_1Module.html">Module</a> : <a class="code" href="classPMTComponents_1_1ProjectItem.html">ProjectItem</a>
00367     {
00368         <span class="keyword">private</span> string projID;
00369 
<a name="l00374"></a><a class="code" href="classPMTComponents_1_1Module.html#PMTComponents_1_1Modulea0">00374</a>         <span class="keyword">public</span> <a class="code" href="classPMTComponents_1_1Module.html#PMTComponents_1_1Modulea0">Module</a>(string id)
00375             : base(id)
00376         {
00377             <span class="keyword">this</span>.myDB = <span class="keyword">new</span> DBDriver();
00378             myDB.Query = <span class="stringliteral">"select * from modules \n"</span> + 
00379                 <span class="stringliteral">"where ID = @ID;"</span>;
00380             myDB.addParam(<span class="stringliteral">"@ID"</span>, id);
00381 
00382             DataSet ds = <span class="keyword">new</span> DataSet();
00383             myDB.createAdapter().Fill(ds);
00384             DataTable table = ds.Tables[0];
00385             DataRow row = table.Rows[0];
00386 
00387             <span class="keyword">this</span>.name = row[<span class="stringliteral">"Name"</span>].ToString();
00388             <span class="keyword">this</span>.id = row[<span class="stringliteral">"id"</span>].ToString();
00389             <span class="keyword">this</span>.projID = row[<span class="stringliteral">"projectID"</span>].ToString();
00390             <span class="keyword">this</span>.description = row[<span class="stringliteral">"description"</span>].ToString();
00391             <span class="keyword">this</span>.startDate = row[<span class="stringliteral">"startDate"</span>].ToString();
00392             <span class="keyword">this</span>.expEndDate = row[<span class="stringliteral">"expEndDate"</span>].ToString();
00393             <span class="keyword">this</span>.actEndDate = row[<span class="stringliteral">"actEndDate"</span>].ToString();
00394         }
00395 
00396         <span class="keyword">public</span> <a class="code" href="classPMTComponents_1_1Module.html#PMTComponents_1_1Modulea0">Module</a>(string name, string projectID, string description, string startDate)
00397             : base(name, description, startDate)
00398         {
00399             DBDriver db = <span class="keyword">new</span> DBDriver();
00400             <span class="comment">// Create Adapter</span>
00401             db.Query = <span class="stringliteral">"select * from Modules"</span>;
00402             MySqlDataAdapter da = db.createAdapter();
00403             <span class="comment">// We need this to get an ID back from the database</span>
00404             da.MissingSchemaAction = MissingSchemaAction.AddWithKey;
00405             <span class="comment">// Create and initialize CommandBuilder</span>
00406             MySqlCommandBuilder dbCB = <span class="keyword">new</span> MySqlCommandBuilder(da);
00407 
00408             <span class="comment">// New DataSet</span>
00409             DataSet ds = <span class="keyword">new</span> DataSet();
00410             <span class="comment">// Populate DataSet with data</span>
00411             da.Fill(ds, <span class="stringliteral">"Modules"</span>);
00412 
00413             <span class="comment">// Get reference to our table</span>
00414             DataTable table = ds.Tables[<span class="stringliteral">"Modules"</span>];
00415             <span class="comment">// Create new row</span>
00416             DataRow  row = table.NewRow();
00417             <span class="comment">// Store data in the row</span>
00418             row[<span class="stringliteral">"Name"</span>] = <span class="keyword">this</span>.name = name;
00419             row[<span class="stringliteral">"projectID"</span>] = <span class="keyword">this</span>.projID = projectID;
00420             row[<span class="stringliteral">"description"</span>] = <span class="keyword">this</span>.description = description;
00421             row[<span class="stringliteral">"startDate"</span>] = <span class="keyword">this</span>.startDate = startDate;
00422             <span class="comment">// Add row back to table</span>
00423             table.Rows.Add(row);
00424 
00425             <span class="comment">// Update data source</span>
00426             da.Update(ds, <span class="stringliteral">"Modules"</span>);
00427 
00428             <span class="comment">// Get newFileID</span>
00429             <span class="keywordflow">if</span>( !row.IsNull(<span class="stringliteral">"ID"</span>) )
00430                 id = row[<span class="stringliteral">"ID"</span>].ToString();
00431 
00432         }
00433         
<a name="l00441"></a><a class="code" href="classPMTComponents_1_1Module.html#PMTComponents_1_1Modulee0">00441</a>         <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classPMTComponents_1_1Module.html#PMTComponents_1_1Modulee0">create</a>(string name, string pID, string description, string startDate)
00442         {
00443             DBDriver myDB = <span class="keyword">new</span> DBDriver();
00444             myDB.Query=<span class="stringliteral">"insert into modules (name, projectID, description, startDate) \n"</span>
00445                 +<span class="stringliteral">"values ( @name, @pID, @desc, @start);"</span>;
00446 
00447             myDB.addParam(<span class="stringliteral">"@name"</span>, name);
00448             myDB.addParam(<span class="stringliteral">"@pID"</span>, pID);
00449             myDB.addParam(<span class="stringliteral">"@desc"</span>, description);
00450             myDB.addParam(<span class="stringliteral">"@start"</span>, startDate);
00451             
00452             myDB.nonQuery();
00453         }
00454 
<a name="l00461"></a><a class="code" href="classPMTComponents_1_1Module.html#PMTComponents_1_1Modulea2">00461</a>         <span class="keyword">new</span> <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classPMTComponents_1_1Module.html#PMTComponents_1_1Modulea2">update</a>(string name, string description, string startDate)
00462         {
00463             base.update(name, description, startDate);
00464 
00465             DBDriver myDB = <span class="keyword">new</span> DBDriver();
00466             myDB.Query=<span class="stringliteral">"update modules \n"</span> 
00467                 +<span class="stringliteral">"set name=@name, description=@desc, startDate=@start \n"</span>
00468                 +<span class="stringliteral">"where id=@id;"</span>;
00469 
00470             myDB.addParam(<span class="stringliteral">"@id"</span>, <span class="keyword">this</span>.id);
00471             myDB.addParam(<span class="stringliteral">"@name"</span>, name);
00472             myDB.addParam(<span class="stringliteral">"@desc"</span>, description);
00473             myDB.addParam(<span class="stringliteral">"@start"</span>, startDate);
00474             
00475             myDB.nonQuery();
00476         }
00477 
<a name="l00482"></a><a class="code" href="classPMTComponents_1_1Module.html#PMTComponents_1_1Modulee1">00482</a>         <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classPMTComponents_1_1Module.html#PMTComponents_1_1Modulee1">remove</a>(string id)
00483         {
00484             DBDriver myDB = <span class="keyword">new</span> DBDriver();
00485             myDB.Query = <span class="stringliteral">"delete from Modules where id=@id"</span>;
00486             myDB.addParam(<span class="stringliteral">"@id"</span>, id);
00487             myDB.nonQuery();
00488         }
00489 
<a name="l00495"></a><a class="code" href="classPMTComponents_1_1Module.html#PMTComponents_1_1Modulee2">00495</a>         <span class="keyword">public</span> <span class="keyword">static</span> DataSet <a class="code" href="classPMTComponents_1_1Module.html#PMTComponents_1_1Modulee2">getByID</a>(string id)
00496         {
00497             DBDriver myDB = <span class="keyword">new</span> DBDriver();
00498             myDB.Query = <span class="stringliteral">"select * from modules \n"</span> + 
00499                 <span class="stringliteral">"where ID = @ID;"</span>;
00500             myDB.addParam(<span class="stringliteral">"@ID"</span>, id);
00501 
00502             DataSet ds = <span class="keyword">new</span> DataSet();
00503             myDB.createAdapter().Fill(ds);
00504             
00505             <span class="keywordflow">return</span> ds;
00506         }
00507 
<a name="l00512"></a><a class="code" href="classPMTComponents_1_1Module.html#PMTComponents_1_1Modulea3">00512</a>         <span class="keyword">public</span> DataSet <a class="code" href="classPMTComponents_1_1Module.html#PMTComponents_1_1Modulea3">getTasksDataSet</a>()
00513         {
00514             myDB.Query = <span class="stringliteral">"select * from tasks\n"</span> +
00515                 <span class="stringliteral">"where moduleID = @ID;"</span>;
00516             myDB.addParam(<span class="stringliteral">"@ID"</span>, id);
00517 
00518             DataSet ds = <span class="keyword">new</span> DataSet();
00519             myDB.createAdapter().Fill(ds);
00520             <span class="keywordflow">return</span> ds;
00521         }
00522 
<a name="l00528"></a><a class="code" href="classPMTComponents_1_1Module.html#PMTComponents_1_1Modulee3">00528</a>         <span class="keyword">public</span> <span class="keyword">static</span> DataSet <a class="code" href="classPMTComponents_1_1Module.html#PMTComponents_1_1Modulee3">getModulesDataSet</a>(string id)
00529         {
00530             DBDriver myDB = <span class="keyword">new</span> DBDriver();
00531             myDB.Query = <span class="stringliteral">"select * from modules\n"</span> +
00532                 <span class="stringliteral">"where projectID = @ID;"</span>;
00533             myDB.addParam(<span class="stringliteral">"@ID"</span>, id);
00534 
00535             DataSet ds = <span class="keyword">new</span> DataSet();
00536             myDB.createAdapter().Fill(ds);
00537             <span class="keywordflow">return</span> ds;
00538         }
00539 
00540         <span class="comment">// TODO: removeTask</span>
00541 
00545         <span class="keyword">public</span> string <a class="code" href="classPMTComponents_1_1Module.html#PMTComponents_1_1Module00">ProjectID</a>
<a name="l00546"></a><a class="code" href="classPMTComponents_1_1Module.html#PMTComponents_1_1Module00">00546</a>         {
00547             get {   <span class="keywordflow">return</span> projID;  }
00548         }
00549         
00553         <span class="keyword">public</span> string <a class="code" href="classPMTComponents_1_1Module.html#PMTComponents_1_1Module01">PercentComplete</a>
<a name="l00554"></a><a class="code" href="classPMTComponents_1_1Module.html#PMTComponents_1_1Module01">00554</a>         {
00555             get
00556             {
00557                 <span class="keywordtype">int</span> count = 0;
00558                 <span class="keywordtype">int</span> approved = 0;
00559 
00560                 DataTable dt = <span class="keyword">this</span>.getTasksDataSet().Tables[0];
00561                 foreach (DataRow row in dt.Rows)
00562                 {
00563                     <span class="keywordflow">if</span> (row[<span class="stringliteral">"complete"</span>].ToString().Equals(<a class="code" href="structPMTComponents_1_1TaskStatus.html">TaskStatus</a>.APPROVED))
00564                         approved++;
00565                     count++;
00566                 }
00567                 <span class="keywordtype">double</span> pct = (<span class="keywordtype">double</span>)approved/(<span class="keywordtype">double</span>)count;
00568                 <span class="keywordflow">if</span> (Double.IsNaN(pct))
00569                     pct = 0;
00570                 <span class="keywordflow">return</span> Convert.ToString(pct.ToString(percentFormatter));
00571             }
00572         }
00573     }
00574 
<a name="l00578"></a><a class="code" href="structPMTComponents_1_1TaskStatus.html">00578</a>     <span class="keyword">public</span> <span class="keyword">struct </span><a class="code" href="structPMTComponents_1_1TaskStatus.html">TaskStatus</a>
00579     {
00580         <span class="keyword">public</span> <span class="keyword">const</span> string COMPLETE   = <span class="stringliteral">"Complete"</span>;   <span class="comment">// dev marks complete</span>
00581         <span class="keyword">public</span> <span class="keyword">const</span> string APPROVED   = <span class="stringliteral">"Approved"</span>;   <span class="comment">// pm marks approved</span>
00582         <span class="keyword">public</span> <span class="keyword">const</span> string INPROGRESS = <span class="stringliteral">"In Progress"</span>;    <span class="comment">// set when assigned</span>
00583         <span class="comment">//public const string NOTSTARTED = "Not Started";</span>
00584         <span class="keyword">public</span> <span class="keyword">const</span> string UNASSIGNED = <span class="stringliteral">"Unassigned"</span>; <span class="comment">// initial value</span>
00585     }
00586 
<a name="l00590"></a><a class="code" href="classPMTComponents_1_1Task.html">00590</a>     <span class="keyword">public</span> <span class="keyword">class </span><a class="code" href="classPMTComponents_1_1Task.html">Task</a> : <a class="code" href="classPMTComponents_1_1ProjectItem.html">ProjectItem</a>
00591     {
00592         string devID;
00593         string modID;
00594         string status;
00595         string complexity;
00596 
<a name="l00601"></a><a class="code" href="classPMTComponents_1_1Task.html#PMTComponents_1_1Taska0">00601</a>         <span class="keyword">public</span> <a class="code" href="classPMTComponents_1_1Task.html#PMTComponents_1_1Taska0">Task</a>(string id)
00602             :base(id)
00603         {
00604             <span class="keyword">this</span>.myDB = <span class="keyword">new</span> DBDriver();
00605             myDB.Query = <span class="stringliteral">"select tasks.name as name, tasks.id as id, tasks.moduleID as modID, tasks.description as description,\n"</span>
00606                 + <span class="stringliteral">"tasks.startDate as startDate, tasks.expEndDate as expEndDate, tasks.actEndDate as actEndDate,\n"</span>
00607                 + <span class="stringliteral">"tasks.complete as complete, tasks.complexity as complexity\n"</span>
00608                 + <span class="stringliteral">"from tasks, assignments \n"</span>
00609                 + <span class="stringliteral">"where tasks.ID = @taskID \n"</span>;
00610             myDB.addParam(<span class="stringliteral">"@taskID"</span>, id);
00611 
00612             DataSet ds = <span class="keyword">new</span> DataSet();
00613             myDB.createAdapter().Fill(ds);
00614             DataTable table = ds.Tables[0];
00615             DataRow row = table.Rows[0];
00616 
00617             <span class="keyword">this</span>.name = row[<span class="stringliteral">"Name"</span>].ToString();
00618             <span class="keyword">this</span>.id = row[<span class="stringliteral">"id"</span>].ToString();
00619             <span class="keyword">this</span>.modID = row[<span class="stringliteral">"modID"</span>].ToString();
00620             <span class="keyword">this</span>.description = row[<span class="stringliteral">"description"</span>].ToString();
00621             <span class="keyword">this</span>.startDate = row[<span class="stringliteral">"startDate"</span>].ToString();
00622             <span class="keyword">this</span>.expEndDate = row[<span class="stringliteral">"expEndDate"</span>].ToString();
00623             <span class="keyword">this</span>.actEndDate = row[<span class="stringliteral">"actEndDate"</span>].ToString();
00624             <span class="keyword">this</span>.status = row[<span class="stringliteral">"complete"</span>].ToString();
00625             <span class="keyword">this</span>.complexity = row[<span class="stringliteral">"complexity"</span>].ToString();
00626 
00627             <span class="comment">// check for an assigned developer</span>
00628             myDB.Query = <span class="stringliteral">"select assignments.devID as devID\n"</span>
00629                         + <span class="stringliteral">"from assignments\n"</span>
00630                         + <span class="stringliteral">"where assignments.taskID = @taskID;"</span>;
00631             myDB.addParam(<span class="stringliteral">"@taskID"</span>, id);
00632 
00633             myDB.addParam(<span class="stringliteral">"@id"</span>, <span class="keyword">this</span>.id);
00634             ds = <span class="keyword">new</span> DataSet();
00635             myDB.createAdapter().Fill(ds);
00636             table = ds.Tables[0];
00637             <span class="keywordflow">if</span> (table.Rows.Count &gt; 0)
00638             {
00639                 row = table.Rows[0];
00640 
00641                 <span class="keywordflow">if</span> (!row[<span class="stringliteral">"devID"</span>].ToString().Equals(String.Empty))
00642                 {
00643                     <span class="keyword">this</span>.devID = row[<span class="stringliteral">"devID"</span>].ToString();
00644                 }
00645             }
00646         }
00647 
00648         <span class="keyword">public</span> <a class="code" href="classPMTComponents_1_1Task.html#PMTComponents_1_1Taska0">Task</a>(string name, string moduleID, string description, string startDate, string compexity)
00649             : base(name, description, startDate)
00650         {
00651             DBDriver db = <span class="keyword">new</span> DBDriver();
00652             <span class="comment">// Create Adapter</span>
00653             db.Query = <span class="stringliteral">"select * from Tasks"</span>;
00654             MySqlDataAdapter da = db.createAdapter();
00655             <span class="comment">// We need this to get an ID back from the database</span>
00656             da.MissingSchemaAction = MissingSchemaAction.AddWithKey;
00657             <span class="comment">// Create and initialize CommandBuilder</span>
00658             MySqlCommandBuilder dbCB = <span class="keyword">new</span> MySqlCommandBuilder(da);
00659 
00660             <span class="comment">// New DataSet</span>
00661             DataSet ds = <span class="keyword">new</span> DataSet();
00662             <span class="comment">// Populate DataSet with data</span>
00663             da.Fill(ds, <span class="stringliteral">"Tasks"</span>);
00664 
00665             <span class="comment">// Get reference to our table</span>
00666             DataTable table = ds.Tables[<span class="stringliteral">"Tasks"</span>];
00667             <span class="comment">// Create new row</span>
00668             DataRow  row = table.NewRow();
00669             <span class="comment">// Store data in the row</span>
00670             row[<span class="stringliteral">"Name"</span>] = <span class="keyword">this</span>.name = name;
00671             row[<span class="stringliteral">"moduleID"</span>] = <span class="keyword">this</span>.modID = moduleID;
00672             row[<span class="stringliteral">"description"</span>] = <span class="keyword">this</span>.description = description;
00673             row[<span class="stringliteral">"startDate"</span>] = <span class="keyword">this</span>.startDate = startDate;
00674             row[<span class="stringliteral">"complete"</span>] = <span class="keyword">this</span>.status = TaskStatus.UNASSIGNED;
00675             row[<span class="stringliteral">"complexity"</span>] = <span class="keyword">this</span>.complexity = compexity;
00676             <span class="comment">// Add row back to table</span>
00677             table.Rows.Add(row);
00678 
00679             <span class="comment">// Update data source</span>
00680             da.Update(ds, <span class="stringliteral">"Tasks"</span>);
00681 
00682             <span class="comment">// Get newFileID</span>
00683             <span class="keywordflow">if</span>( !row.IsNull(<span class="stringliteral">"ID"</span>) )
00684                 id = row[<span class="stringliteral">"ID"</span>].ToString();
00685 
00686         }
00687 
<a name="l00695"></a><a class="code" href="classPMTComponents_1_1Task.html#PMTComponents_1_1Taske0">00695</a>         <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classPMTComponents_1_1Task.html#PMTComponents_1_1Taske0">create</a>(string name, string mID, string description, string startDate)
00696         {
00697             DBDriver myDB = <span class="keyword">new</span> DBDriver();
00698             myDB.Query=<span class="stringliteral">"insert into tasks (name, moduleID, description, startDate, complete) \n"</span>
00699                 +<span class="stringliteral">"values ( @name, @mID, @desc, @start, @complete );"</span>;
00700 
00701             myDB.addParam(<span class="stringliteral">"@name"</span>, name);
00702             myDB.addParam(<span class="stringliteral">"@mID"</span>, mID);
00703             myDB.addParam(<span class="stringliteral">"@desc"</span>, description);
00704             myDB.addParam(<span class="stringliteral">"@start"</span>, startDate);
00705             myDB.addParam(<span class="stringliteral">"@complete"</span>, <a class="code" href="structPMTComponents_1_1TaskStatus.html">TaskStatus</a>.UNASSIGNED);
00706 
00707             myDB.nonQuery();
00708         }
00709 
<a name="l00716"></a><a class="code" href="classPMTComponents_1_1Task.html#PMTComponents_1_1Taska2">00716</a>         <span class="keyword">new</span> <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classPMTComponents_1_1Task.html#PMTComponents_1_1Taska2">update</a>(string name, string description, string startDate)
00717         {
00718             base.update(name, description, startDate);
00719 
00720             DBDriver myDB = <span class="keyword">new</span> DBDriver();
00721             myDB.Query=<span class="stringliteral">"update tasks \n"</span> 
00722                 +<span class="stringliteral">"set name=@name, description=@desc, startDate=@start\n"</span>
00723                 +<span class="stringliteral">"where id=@id;"</span>;
00724 
00725             myDB.addParam(<span class="stringliteral">"@id"</span>, <span class="keyword">this</span>.id);
00726             myDB.addParam(<span class="stringliteral">"@name"</span>, name);
00727             myDB.addParam(<span class="stringliteral">"@desc"</span>, description);
00728             myDB.addParam(<span class="stringliteral">"@start"</span>, startDate);
00729             
00730             myDB.nonQuery();
00731         }
00732 
<a name="l00737"></a><a class="code" href="classPMTComponents_1_1Task.html#PMTComponents_1_1Taske1">00737</a>         <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classPMTComponents_1_1Task.html#PMTComponents_1_1Taske1">remove</a>(string id)
00738         {
00739             DBDriver myDB = <span class="keyword">new</span> DBDriver();
00740             myDB.Query = <span class="stringliteral">"delete from Tasks where id=@id"</span>;
00741             myDB.addParam(<span class="stringliteral">"@id"</span>, id);
00742             myDB.nonQuery();
00743         }
00744 
<a name="l00750"></a><a class="code" href="classPMTComponents_1_1Task.html#PMTComponents_1_1Taske2">00750</a>         <span class="keyword">public</span> <span class="keyword">static</span> DataSet <a class="code" href="classPMTComponents_1_1Task.html#PMTComponents_1_1Taske2">getByID</a>(string id)
00751         {
00752             DBDriver myDB = <span class="keyword">new</span> DBDriver();
00753             myDB.Query = <span class="stringliteral">"select * from tasks \n"</span> + 
00754                 <span class="stringliteral">"where ID = @ID;"</span>;
00755             myDB.addParam(<span class="stringliteral">"@ID"</span>, id);
00756 
00757             DataSet ds = <span class="keyword">new</span> DataSet();
00758             myDB.createAdapter().Fill(ds);
00759             
00760             <span class="keywordflow">return</span> ds;
00761         }
00762 
<a name="l00768"></a><a class="code" href="classPMTComponents_1_1Task.html#PMTComponents_1_1Taske3">00768</a>         <span class="keyword">public</span> <span class="keyword">static</span> DataSet <a class="code" href="classPMTComponents_1_1Task.html#PMTComponents_1_1Taske3">getTasksDataSet</a>(string id)
00769         {
00770             DBDriver myDB = <span class="keyword">new</span> DBDriver();
00771             myDB.Query = <span class="stringliteral">"select * from tasks\n"</span> +
00772                 <span class="stringliteral">"where moduleID = @ID;"</span>;
00773             myDB.addParam(<span class="stringliteral">"@ID"</span>, id);
00774 
00775             DataSet ds = <span class="keyword">new</span> DataSet();
00776             myDB.createAdapter().Fill(ds);
00777             <span class="keywordflow">return</span> ds;
00778         }
00779 
<a name="l00784"></a><a class="code" href="classPMTComponents_1_1Task.html#PMTComponents_1_1Taska3">00784</a>         <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classPMTComponents_1_1Task.html#PMTComponents_1_1Taska3">assignDeveloper</a>(string devID)
00785         {
00786             <span class="keyword">this</span>.devID = devID;
00787 
00788             DBDriver db = <span class="keyword">new</span> DBDriver();
00789             db.Query = <span class="stringliteral">"insert into assignments (taskID, devID, dateAss)\n"</span>
00790                         + <span class="stringliteral">"values (@taskID, @devID, @date)"</span>;
00791             db.addParam(<span class="stringliteral">"@taskID"</span>, <span class="keyword">this</span>.id);
00792             db.addParam(<span class="stringliteral">"@devID"</span>, devID);
00793             db.addParam(<span class="stringliteral">"@date"</span>, Convert.ToString(DateTime.Now));
00794             db.nonQuery();
00795             
00796             db.Query = <span class="stringliteral">"update tasks set complete = @complete\n"</span>
00797                      + <span class="stringliteral">"where ID = @taskID;"</span>;
00798             db.addParam(<span class="stringliteral">"@complete"</span>, <a class="code" href="structPMTComponents_1_1TaskStatus.html">TaskStatus</a>.INPROGRESS);
00799             db.addParam(<span class="stringliteral">"@taskID"</span>, <span class="keyword">this</span>.id);
00800             db.nonQuery();
00801 
00802             db.Query = <span class="stringliteral">"select competence from compLevels where ID = @devID"</span>;
00803             db.addParam(<span class="stringliteral">"@devID"</span>, devID);
00804             MySqlDataReader dr = db.createReader();
00805             dr.Read();
00806             string competence = dr[<span class="stringliteral">"competence"</span>].ToString();
00807             db.close();
00808             string length;
00809 
00810             <span class="keywordflow">if</span>( complexity == <span class="stringliteral">"Low"</span> )
00811               db.Query = <span class="stringliteral">"select lowComplexity as length from compmatrix where compLevel = @competence"</span>;
00812             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( complexity == <span class="stringliteral">"Medium"</span> )
00813               db.Query = <span class="stringliteral">"select medComplexity as length from compmatrix where compLevel = @competence"</span>;
00814             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( complexity == <span class="stringliteral">"High"</span> )
00815               db.Query = <span class="stringliteral">"select highComplexity as length from compmatrix where compLevel = @competence"</span>;
00816 
00817             db.addParam(<span class="stringliteral">"@competence"</span>, competence);
00818             dr = db.createReader();
00819             dr.Read();
00820             length = dr[<span class="stringliteral">"length"</span>].ToString();
00821             db.close();
00822    
00823             <span class="comment">//TimeSpan temp = new TimeSpan(Convert.ToInt32(length), 0, 0, 0);</span>
00824             DateTime start = Convert.ToDateTime(<span class="keyword">this</span>.startDate);
00825             <span class="keywordtype">double</span> hours = Convert.ToDouble(length);
00826             <span class="keywordtype">double</span> days = Math.Ceiling(hours/8);
00827             DateTime end = start.AddDays(days);
00828             <span class="keyword">this</span>.expEndDate = end.ToShortDateString();
00829 
00830             db.Query = <span class="stringliteral">"update tasks set expEndDate = @expEndDate\n"</span>
00831                 + <span class="stringliteral">"where ID = @taskID;"</span>;
00832             db.addParam(<span class="stringliteral">"@expEndDate"</span>, <span class="keyword">this</span>.expEndDate);
00833             db.addParam(<span class="stringliteral">"@taskID"</span>, <span class="keyword">this</span>.id);
00834             db.nonQuery();
00835 <span class="comment">//TODO</span>
00836 <span class="comment">//          modid = ||select moduleid from tasks where id = @taskid;</span>
00837 <span class="comment">//</span>
00838 <span class="comment">//maximum = max of ||select tasks.expenddate from tasks where tasks.moduleid = @modid</span>
00839 <span class="comment">//</span>
00840 <span class="comment">//update modules set expenddate = @maximum where id = @modid</span>
00841 <span class="comment">//</span>
00842 <span class="comment">//projid = ||select projectid from modules where id = @modid</span>
00843 <span class="comment">//</span>
00844 <span class="comment">//maximum = max of ||select expenddate from modules where projectid = @projid</span>
00845 <span class="comment">//</span>
00846 <span class="comment">//update project set expenddate = @maximum where id = @projid</span>
00847 
00848 
00849         
00850         }
00851 
00855         <span class="keyword">public</span> string <a class="code" href="classPMTComponents_1_1Task.html#PMTComponents_1_1Task00">DeveloperID</a>
<a name="l00856"></a><a class="code" href="classPMTComponents_1_1Task.html#PMTComponents_1_1Task00">00856</a>         {
00857             get {   <span class="keywordflow">return</span> devID;   }
00858             set {   <a class="code" href="classPMTComponents_1_1Task.html#PMTComponents_1_1Taska3">assignDeveloper</a>(value); }
00859         }
00860 
00864         <span class="keyword">public</span> string <a class="code" href="classPMTComponents_1_1Task.html#PMTComponents_1_1Task01">ModuleID</a>
<a name="l00865"></a><a class="code" href="classPMTComponents_1_1Task.html#PMTComponents_1_1Task01">00865</a>         {
00866             get {   <span class="keywordflow">return</span> modID;   }
00867         }
00868 
00872         <span class="keyword">public</span> string <a class="code" href="classPMTComponents_1_1Task.html#PMTComponents_1_1Task02">Status</a>
<a name="l00873"></a><a class="code" href="classPMTComponents_1_1Task.html#PMTComponents_1_1Task02">00873</a>         {
00874             get {   <span class="keywordflow">return</span> status;  }
00875             set 
00876             {   
00877                 status = value;
00878                 DBDriver db = <span class="keyword">new</span> DBDriver();
00879                 db.Query = 
00880                     <span class="stringliteral">"update tasks set complete=@complete\n"</span>
00881                     + <span class="stringliteral">"where id=@id;"</span>;
00882                 db.addParam(<span class="stringliteral">"@complete"</span>, status);
00883                 db.addParam(<span class="stringliteral">"@id"</span>, <span class="keyword">this</span>.id);
00884                 db.nonQuery();
00885             }
00886         }
00887 
00891         <span class="keyword">public</span> string <a class="code" href="classPMTComponents_1_1Task.html#PMTComponents_1_1Task03">PercentComplete</a>
<a name="l00892"></a><a class="code" href="classPMTComponents_1_1Task.html#PMTComponents_1_1Task03">00892</a>         {
00893             get
00894             {
00895                 <span class="keywordtype">double</span> pct;
00896                 <span class="keywordflow">if</span> (status.Equals(<a class="code" href="structPMTComponents_1_1TaskStatus.html">TaskStatus</a>.APPROVED))
00897                     pct = 1;
00898                 <span class="keywordflow">else</span>
00899                     pct = 0;
00900 
00901                 <span class="keywordflow">return</span> Convert.ToString(pct.ToString(percentFormatter));
00902             }
00903         }
00904     }
00905 }
</pre></div><hr><address style="align: right;"><small>
Generated on Sat Aug 5 14:40:47 2006 for PMT by <a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 width=110 height=53>
</a> 1.3.1 using KingsTools</small></address>
</body>
</html>
