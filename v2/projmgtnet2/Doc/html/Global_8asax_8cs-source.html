<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>PMT: Global.asax.cs Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.1 -->
<h1>Global.asax.cs</h1><div class="fragment"><pre>00001 <span class="keyword">using</span> System;
00002 <span class="keyword">using</span> System.Collections;
00003 <span class="keyword">using</span> System.ComponentModel;
00004 <span class="keyword">using</span> System.Web;
00005 <span class="keyword">using</span> System.Web.SessionState;
00006 <span class="keyword">using</span> System.Web.Security;
00007 <span class="keyword">using</span> System.Security.Principal;
00008 <span class="keyword">using</span> System.Configuration;
00009 <span class="keyword">using</span> System.Collections.Specialized;
00010 
00011 <span class="keyword">namespace </span>PMT 
00012 {
00013     <span class="keyword">public</span> <span class="keyword">class </span>Global : HttpApplication
00014     {
00018         <span class="keyword">private</span> System.ComponentModel.IContainer components = null;
00019 
00020         <span class="keyword">public</span> Global()
00021         {
00022             InitializeComponent();
00023         }   
00024         
00025 <span class="preprocessor">        #region HttpApplication Events</span>
00026 <span class="preprocessor"></span>        <span class="keyword">protected</span> <span class="keywordtype">void</span> Application_Start(Object sender, EventArgs e)
00027         {
00028 
00029         }
00030  
00031         <span class="keyword">protected</span> <span class="keywordtype">void</span> Session_Start(Object sender, EventArgs e)
00032         {
00033 
00034         }
00035 
00036         <span class="keyword">protected</span> <span class="keywordtype">void</span> Application_BeginRequest(Object sender, EventArgs e)
00037         {
00038 
00039         }
00040 
00041         <span class="keyword">protected</span> <span class="keywordtype">void</span> Application_EndRequest(Object sender, EventArgs e)
00042         {
00043 
00044         }
00045 
00046         <span class="keywordtype">void</span> Application_AuthenticateRequest (Object sender, EventArgs e)
00047         {
00048             HttpApplication app = (HttpApplication) sender;
00049 
00050             <span class="keywordflow">if</span> (app.Request.IsAuthenticated &amp;&amp;
00051                 app.User.Identity is FormsIdentity) 
00052             {
00053                 FormsIdentity identity = (FormsIdentity) app.User.Identity;
00054 
00055                 <span class="comment">// Find out what role (if any) the user belongs to</span>
00056                 <span class="comment">//string role = identity.Name;</span>
00057 
00058                 <span class="keywordflow">if</span> (Request.Cookies[<span class="stringliteral">"user"</span>] != null)
00059                 {
00060                     string role = Request.Cookies[<span class="stringliteral">"user"</span>][<span class="stringliteral">"role"</span>];
00061 
00062                     <span class="comment">// Create a GenericPrincipal containing the role name</span>
00063                     <span class="comment">// and assign it to the current request</span>
00064                     app.Context.User = 
00065                         <span class="keyword">new</span> GenericPrincipal(identity, <span class="keyword">new</span> string[] { role });
00066                 }
00067             }
00068         }
00069 
00070         <span class="keyword">protected</span> <span class="keywordtype">void</span> Application_Error(Object sender, EventArgs e)
00071         {
00072 
00073         }
00074 
00075         <span class="keyword">protected</span> <span class="keywordtype">void</span> Session_End(Object sender, EventArgs e)
00076         {
00077 
00078         }
00079 
00080         <span class="keyword">protected</span> <span class="keywordtype">void</span> Application_End(Object sender, EventArgs e)
00081         {
00082 
00083         }
00084 <span class="preprocessor">        #endregion</span>
00085 <span class="preprocessor"></span>
00086 <span class="preprocessor">        #region Web.config Settings</span>
00087 <span class="preprocessor"></span><span class="preprocessor">        #region CSS Classes</span>
00088 <span class="preprocessor"></span>        <span class="keyword">public</span> <span class="keyword">static</span> string DataGridStyle
00089         {
00090             get {   <span class="keywordflow">return</span> GetConfigSetting(<span class="stringliteral">""</span>, <span class="stringliteral">"DataGridStyle"</span>);           }
00091         }
00092         <span class="keyword">public</span> <span class="keyword">static</span> string DataGridItemStyle
00093         {
00094             get {   <span class="keywordflow">return</span> GetConfigSetting(<span class="stringliteral">""</span>, <span class="stringliteral">"DataGridItemStyle"</span>);       }
00095         }
00096         <span class="keyword">public</span> <span class="keyword">static</span> string DataGridAltItemStyle
00097         {
00098             get {   <span class="keywordflow">return</span> GetConfigSetting(<span class="stringliteral">""</span>, <span class="stringliteral">"DataGridAltItemStyle"</span>);    }
00099         }
00100         <span class="keyword">public</span> <span class="keyword">static</span> string DataGridHeaderStyle
00101         {
00102             get {   <span class="keywordflow">return</span> GetConfigSetting(<span class="stringliteral">""</span>, <span class="stringliteral">"DataGridHeaderStyle"</span>);     }
00103         }
00104 <span class="preprocessor">        #endregion</span>
00105 <span class="preprocessor"></span>
00112         <span class="keyword">private</span> <span class="keyword">static</span> string GetConfigSetting(string section, string setting)
00113         {
00114             <span class="keywordflow">if</span> (section == String.Empty)
00115                 <span class="keywordflow">return</span> ConfigurationSettings.AppSettings[setting];
00116             <span class="keywordflow">else</span>
00117                 <span class="keywordflow">return</span> ((NameValueCollection)ConfigurationSettings.GetConfig(section))[setting];
00118         }
00119 
00120 <span class="preprocessor">        #endregion</span>
00121 <span class="preprocessor"></span>
00122 <span class="preprocessor">        #region Web Form Designer generated code</span>
00127 <span class="preprocessor">        private void InitializeComponent()</span>
00128 <span class="preprocessor"></span>        {    
00129             <span class="keyword">this</span>.components = <span class="keyword">new</span> System.ComponentModel.Container();
00130         }
00131 <span class="preprocessor">        #endregion</span>
00132 <span class="preprocessor"></span>    }
00133 }
00134 
</pre></div><hr><address style="align: right;"><small>
Generated on Sun Aug 6 23:06:02 2006 for PMT by <a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 width=110 height=53>
</a> 1.3.1 using KingsTools</small></address>
</body>
</html>
