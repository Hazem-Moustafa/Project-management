<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>PMT: D:/My Documents/Visual Studio Projects/projmgtnet2/Global.asax.cs Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.1 -->
<h1>D:/My Documents/Visual Studio Projects/projmgtnet2/Global.asax.cs</h1><div class="fragment"><pre>00001 <span class="keyword">using</span> System;
00002 <span class="keyword">using</span> System.Collections;
00003 <span class="keyword">using</span> System.ComponentModel;
00004 <span class="keyword">using</span> System.Web;
00005 <span class="keyword">using</span> System.Web.SessionState;
00006 <span class="keyword">using</span> System.Web.Security;
00007 <span class="keyword">using</span> System.Security.Principal;
00008 
00009 <span class="keyword">namespace </span>PMT 
00010 {
<a name="l00014"></a><a class="code" href="classPMT_1_1Global.html">00014</a>     <span class="keyword">public</span> <span class="keyword">class </span><a class="code" href="classPMT_1_1Global.html">Global</a> : HttpApplication
00015     {
<a name="l00019"></a><a class="code" href="classPMT_1_1Global.html#PMT_1_1Globalr0">00019</a>         <span class="keyword">private</span> System.ComponentModel.IContainer <a class="code" href="classPMT_1_1Global.html#PMT_1_1Globalr0">components</a> = null;
00020 
00021         <span class="keyword">public</span> <a class="code" href="classPMT_1_1Global.html">Global</a>()
00022         {
00023             <a class="code" href="classPMT_1_1Global.html#PMT_1_1Globald1">InitializeComponent</a>();
00024         }   
00025         
00026         <span class="keyword">protected</span> <span class="keywordtype">void</span> Application_Start(Object sender, EventArgs e)
00027         {
00028 
00029         }
00030  
00031         <span class="keyword">protected</span> <span class="keywordtype">void</span> Session_Start(Object sender, EventArgs e)
00032         {
00033 
00034         }
00035 
00036         <span class="keyword">protected</span> <span class="keywordtype">void</span> Application_BeginRequest(Object sender, EventArgs e)
00037         {
00038 
00039         }
00040 
00041         <span class="keyword">protected</span> <span class="keywordtype">void</span> Application_EndRequest(Object sender, EventArgs e)
00042         {
00043 
00044         }
00045 
00046         <span class="keywordtype">void</span> Application_AuthenticateRequest (Object sender, EventArgs e)
00047         {
00048             HttpApplication app = (HttpApplication) sender;
00049 
00050             <span class="keywordflow">if</span> (app.Request.IsAuthenticated &amp;&amp;
00051                 app.User.Identity is FormsIdentity) 
00052             {
00053                 FormsIdentity identity = (FormsIdentity) app.User.Identity;
00054 
00055                 <span class="comment">// Find out what role (if any) the user belongs to</span>
00056                 <span class="comment">//string role = identity.Name;</span>
00057 
00058                 <span class="keywordflow">if</span> (Request.Cookies[<span class="stringliteral">"user"</span>] != null)
00059                 {
00060                     string role = Request.Cookies[<span class="stringliteral">"user"</span>][<span class="stringliteral">"role"</span>];
00061 
00062                     <span class="comment">// Create a GenericPrincipal containing the role name</span>
00063                     <span class="comment">// and assign it to the current request</span>
00064                     app.Context.User = 
00065                         <span class="keyword">new</span> GenericPrincipal(identity, <span class="keyword">new</span> string[] { role });
00066                 }
00067             }
00068         }
00069 
00070         <span class="keyword">protected</span> <span class="keywordtype">void</span> Application_Error(Object sender, EventArgs e)
00071         {
00072 
00073         }
00074 
00075         <span class="keyword">protected</span> <span class="keywordtype">void</span> Session_End(Object sender, EventArgs e)
00076         {
00077 
00078         }
00079 
00080         <span class="keyword">protected</span> <span class="keywordtype">void</span> Application_End(Object sender, EventArgs e)
00081         {
00082 
00083         }
00084 
00085 <span class="preprocessor">        #region Web Form Designer generated code</span>
<a name="l00090"></a><a class="code" href="classPMT_1_1Global.html#PMT_1_1Globald1">00090</a> <span class="preprocessor">        private void InitializeComponent()</span>
00091 <span class="preprocessor"></span>        {    
00092             <span class="keyword">this</span>.components = <span class="keyword">new</span> System.ComponentModel.Container();
00093         }
00094 <span class="preprocessor">        #endregion</span>
00095 <span class="preprocessor"></span>    }
00096 }
00097 
</pre></div><hr><address style="align: right;"><small>
Generated on Sat Aug 5 14:40:47 2006 for PMT by <a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 width=110 height=53>
</a> 1.3.1 using KingsTools</small></address>
</body>
</html>
